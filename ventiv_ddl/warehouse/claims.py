# Databricks notebook source
spark.sql("USE CATALOG hive_metastore")
spark.sql("USE SCHEMA delta_nip")

# COMMAND ----------

from pyspark.sql import SparkSession

# Create a Spark session
spark_session = SparkSession.builder.appName("delta_nip").getOrCreate()
# SQL code without %sql magic command
sql_code = """CREATE OR REPLACE TABLE delta_nip.claims (
  as_of DATE,
  book STRING,
  account_name STRING,
  specialty_program STRING,
  carrier STRING,
  LOB STRING,
  accident_am_or_pm STRING,
  accident_address_1 STRING,
  accident_address_2 STRING,
  accident_address_3 STRING,
  accident_city STRING,
  accident_county STRING,
  accident_department STRING,
  accident_description STRING,
  accident_map STRING,
  accident_postal_code STRING,
  accident_shift STRING,
  accident_state STRING,
  accident_time STRING,
  account_id STRING,
  activity_before_loss STRING,
  address_claimant_address_1 STRING,
  address_claimant_address_2 STRING,
  address_claimant_address_3 STRING,
  address_claimant_city STRING,
  address_claimant_postal_code STRING,
  address_claimant_state STRING,
  alternate_claim_number STRING,
  area_of_accident STRING,
  attorney_representation_date DATE,
  basel_business_line STRING,
  basel_loss_event_type STRING,
  benefit_state STRING,
  bodily_injury STRING,
  body_ncci INTEGER,
  captive_os_expense DOUBLE,
  captive_os_indemnity_bi_pd_coll DOUBLE,
  captive_os_legal DOUBLE,
  captive_os_medical_comp DOUBLE,
  captive_os_other DOUBLE,
  captive_os_total DOUBLE,
  captive_paid_expense DOUBLE,
  captive_paid_indem_bi_pd_coll DOUBLE,
  captive_paid_legal DOUBLE,
  captive_paid_medical_comp DOUBLE,
  captive_paid_other DOUBLE,
  captive_paid_total DOUBLE,
  case_type STRING,
  cause STRING,
  cause_ncci INTEGER,
  claim_deductible DOUBLE,
  claim_number STRING,
  claim_or_incident STRING,
  claim_stage STRING,
  claim_status STRING,
  claimant_death_date DATE,
  claimant_first_name STRING,
  claimant_last_name STRING,
  claimant_m_i STRING,
  claimant_name STRING,
  claimant_title STRING,
  claims_made_date DATE,
  claim_created_date DATE,
  claim_currency_iso_code STRING,
  claim_last_updated_date_char STRING,
  clash_claim STRING,
  class_code STRING,
  closed_date DATE,
  construction_defect STRING,
  controverted STRING,
  coverage STRING,
  coverage_code STRING,
  created_by STRING,
  created_by_data_process STRING,
  created_date DATE,
  created_date_rc_claim DATE,
  TPA STRING,
  date_suit_filed DATE,
  date_placed_in_litigation DATE,
  dates_source_claims_made_date DATE,
  dates_source_close_date DATE,
  dates_source_entry_date DATE,
  dates_source_loss_date DATE,
  dates_source_reopen_date DATE,
  dates_source_report_date DATE,
  days_paid DOUBLE,
  dde_copy_data_from_ee_record STRING,
  ded_sir_os_expense DOUBLE,
  ded_sir_os_indemnity_bi_pd_coll DOUBLE,
  ded_sir_os_legal DOUBLE,
  ded_sir_os_medical_comp DOUBLE,
  ded_sir_os_other DOUBLE,
  ded_sir_os_total DOUBLE,
  ded_sir_paid_expense DOUBLE,
  ded_sir_paid_indem_bi_pd_coll DOUBLE,
  ded_sir_paid_legal DOUBLE,
  ded_sir_paid_medical_comp DOUBLE,
  ded_sir_paid_other DOUBLE,
  ded_sir_paid_total DOUBLE,
  deductible_description STRING,
  deductible_from_policy STRING,
  descr_amtrust_spoiled_claim_num STRING,
  descriptors_source_body_part STRING,
  descriptors_source_cause STRING,
  descriptors_source_coverage STRING,
  descriptors_source_location STRING,
  descriptors_source_nature STRING,
  descriptors_source_pol_eff_date DATE,
  descriptors_source_policy_number STRING,
  descriptors_source_policy_period STRING,
  descriptors_source_state STRING,
  descriptors_source_status STRING,
  descriptors_travelers_sai_number STRING,
  descr_travelers_st_paul_pol_num STRING,
  downtime_units STRING,
  driver_age DOUBLE,
  driver_birth_date DATE,
  driver_first_name STRING,
  driver_last_name STRING,
  driver_m_i STRING,
  driver_relationship STRING,
  driver_sex STRING,
  driver_title STRING,
  drivers_license_number STRING,
  driver_vehicle_additional_info STRING,
  drivers_first_name STRING,
  employer_notification_date DATE,
  first_aid_care STRING,
  garage_state STRING,
  gross_incurred_expense DOUBLE,
  gross_incurred_indem_bi_pd_coll DOUBLE,
  gross_incurred_legal DOUBLE,
  gross_incurred_medical_comp DOUBLE,
  gross_incurred_other DOUBLE,
  gross_incurred_total DOUBLE,
  healthcare_address_1 STRING,
  healthcare_address_2 STRING,
  healthcare_city STRING,
  healthcare_phone STRING,
  healthcare_postal_code STRING,
  healthcare_provider_type STRING,
  healthcare_state STRING,
  hire_car_required STRING,
  hospitalized_overnight STRING,
  id_for_data_loads STRING,
  in_litigation STRING,
  information_claimant_age DOUBLE,
  info_claimant_date_of_birth DATE,
  information_claimant_gender STRING,
  information_claimant_job_title STRING,
  info_claimant_marital_status STRING,
  info_claimant_phone_number STRING,
  information_email STRING,
  information_employee_id STRING,
  information_employee_status STRING,
  information_employment_end_date DATE,
  info_employment_start_date DATE,
  information_hire_date DATE,
  information_job_termination_date DATE,
  information_ncci_class_code STRING,
  info_occupation_when_injured STRING,
  information_supervisor_email STRING,
  information_supervisor_name STRING,
  information_tax_id STRING,
  information_tax_id_admin STRING,
  information_wage_amount DOUBLE,
  information_wage_type STRING,
  initial_reserve DOUBLE,
  initial_treatment_date DATE,
  injury_or_illness_description STRING,
  insured_name STRING,
  insured_driver_citation STRING,
  insured_driver_information STRING,
  insured_driver_injured STRING,
  insured_driver_injury_desc STRING,
  insured_vehicle_damage_desc STRING,
  insured_vehicle_damaged STRING,
  insurer_os_expense DOUBLE,
  insurer_os_indemnity_bi_pd_coll DOUBLE,
  insurer_os_legal DOUBLE,
  insurer_os_medical_comp DOUBLE,
  insurer_os_other DOUBLE,
  insurer_os_total DOUBLE,
  insurer_paid_expense DOUBLE,
  insurer_paid_indem_bi_pd_coll DOUBLE,
  insurer_paid_legal DOUBLE,
  insurer_paid_medical_comp DOUBLE,
  insurer_paid_other DOUBLE,
  insurer_paid_total DOUBLE,
  jif_incurred DOUBLE,
  jif_paid DOUBLE,
  last_financial_update DATE,
  last_load_date DATE,
  last_updated_by STRING,
  last_updated_date DATE,
  last_worked_date DATE,
  loss_date DATE,
  loss_description_code STRING,
  lost_days DOUBLE,
  lot_number STRING,
  managed_care_fees STRING,
  manufactured_date DATE,
  medical_treatment_sought STRING,
  model_number STRING,
  nature STRING,
  nature_ncci STRING,
  net_incurred_expense DOUBLE,
  net_incurred_indem_bi_pd_coll DOUBLE,
  net_incurred_legal DOUBLE,
  net_incurred_medical_comp DOUBLE,
  net_incurred_other DOUBLE,
  net_incurred_total DOUBLE,
  object_substance_causing_harm STRING,
  occ_severity_code STRING,
  occurrence_lead_claim STRING,
  event_number STRING,
  office_code STRING,
  organization STRING,
  osha_completed_by_rep STRING,
  osha_injury_type STRING,
  osha_privacy STRING,
  osha_recordable STRING,
  osha_rep_phone STRING,
  osha_rep_title STRING,
  part STRING,
  physician_healthcare_name STRING,
  police_professional_liability STRING,
  pol_eff_dt DATE,
  pol_exp_dt DATE,
  policy_number STRING,
  policy_record_id DOUBLE,
  policy_year DOUBLE,
  primary_insurer_limit STRING,
  product_name STRING,
  program_name STRING,
  property_damage STRING,
  purpose_of_journey STRING,
  ql_case_type STRING,
  recovery_expected_expense DOUBLE,
  recov_expected_indem_bi_pd_coll DOUBLE,
  recovery_expected_legal DOUBLE,
  recovery_expected_medical_comp DOUBLE,
  recovery_expected_other DOUBLE,
  recovery_expected_total DOUBLE,
  recovery_paid DOUBLE,
  recovery_received_expense DOUBLE,
  recov_received_indem_bi_pd_coll DOUBLE,
  recovery_received_legal DOUBLE,
  recovery_received_medical_comp DOUBLE,
  recovery_received_other DOUBLE,
  recovery_received_total DOUBLE,
  reimbursement STRING,
  reimbursement_amount DOUBLE,
  reinsurance_recovery DOUBLE,
  release_to_work_date DATE,
  reopen_date DATE,
  reopened STRING,
  report_date DATE,
  report_lag DOUBLE,
  restricted_days DOUBLE,
  return_to_work_date DATE,
  road_conditions STRING,
  road_type STRING,
  salvage_indicator STRING,
  salvage_recovery DOUBLE,
  serial_number STRING,
  subro_indicator STRING,
  subro_recovery DOUBLE,
  suit_date DATE,
  time_employee_began_work STRING,
  total_incurred_net DOUBLE,
  total_loss STRING,
  total_outstanding DOUBLE,
  total_paid DOUBLE,
  total_paid_net DOUBLE,
  total_recovery DOUBLE,
  town_incurred DOUBLE,
  town_paid DOUBLE,
  tpa_adjuster STRING,
  treated_in_er STRING,
  user_claim_type_override STRING,
  vehicle_description STRING,
  vehicle_downtime STRING,
  vehicle_make STRING,
  vehicle_model STRING,
  vehicle_number STRING,
  vehicle_tag STRING,
  vehicle_year DOUBLE,
  vin STRING,
  visibility STRING,
  weather_conditions STRING,
  work_began_am_or_pm STRING,
  year DOUBLE,
  claim_last_updated_date DATE,
  cov_desc STRING,
  cov_desc_detail STRING)
;

"""
spark_session.sql(sql_code)
