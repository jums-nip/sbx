# Databricks notebook source
# Databricks notebook source
from pyspark.sql import SparkSession

# Create a Spark session
spark_session = SparkSession.builder.appName("nip_refined").getOrCreate()
# SQL code without %sql magic command
sql_code = """CREATE OR REPLACE TABLE nip_refined.premium (
  as_of DATE,
  book STRING,
  account_name STRING,
  specialty_program STRING,
  carrier STRING,
  LOB STRING,
  al_premium FLOAT,
  al_or_apd_breakout STRING,
  apd_premium FLOAT,
  arborist_limit FLOAT,
  assigned_risk STRING,
  auto_liability_premium FLOAT,
  base_zone STRING,
  blanket_waiver STRING,
  broadened_cov_for_contractors STRING,
  building_deductible FLOAT,
  building_limit FLOAT,
  business_income_annual_premium FLOAT,
  business_income_deductible FLOAT,
  business_income_limit FLOAT,
  business_income_transaction_prem FLOAT,
  ca_territory_credit FLOAT,
  cat_coverage STRING,
  calculation_type_broker_fee STRING,
  calculation_type_fees STRING,
  calculation_type_fronting_charge STRING,
  calculation_type_other STRING,
  calculation_type_tax STRING,
  cancel_flag STRING,
  certified_acts_of_terrorism STRING,
  class_csp STRING,
  governing_class_code STRING,
  consent_to_rate STRING,
  construction_class STRING,
  construction_class_ii STRING,
  contact_email STRING,
  contact_name STRING,
  contact_phone_number STRING,
  contents_deductible FLOAT,
  contents_limit FLOAT,
  coverage STRING,
  created_by STRING,
  created_date DATE,
  created_date_rc_prem DATE,
  dot_number STRING,
  damage_to_rented_premises STRING,
  deductible FLOAT,
  ded_amnt_ded_1 FLOAT,
  ded_amnt_ded_14 FLOAT,
  ded_amnt_ded_15 FLOAT,
  ded_amnt_ded_16 FLOAT,
  ded_amnt_ded_2 FLOAT,
  ded_amnt_ded_3 FLOAT,
  ded_amnt_ded_4 FLOAT,
  ded_amnt_ded_5 FLOAT,
  ded_amnt_ded_6 FLOAT,
  ded_desc_ded_1 STRING,
  ded_desc_ded_14 STRING,
  ded_desc_ded_15 STRING,
  ded_desc_ded_16 STRING,
  ded_desc_ded_2 STRING,
  ded_desc_ded_3 STRING,
  ded_desc_ded_4 STRING,
  ded_desc_ded_5 STRING,
  ded_desc_ded_6 STRING,
  earthquake_ded FLOAT,
  expense_mod FLOAT,
  experience_mod FLOAT,
  fein STRING,
  firm STRING,
  class_code STRING,
  guaranteed_cost_flag STRING,
  id_used_for_data_loads STRING,
  insured_address_1 STRING,
  insured_address_2 STRING,
  insured_city STRING,
  insured_name STRING,
  insured_state STRING,
  insured_zip STRING,
  insurer STRING,
  is_renewal STRING,
  is_this_tax STRING,
  lcm FLOAT,
  landscape_or_arborist_services STRING,
  last_updated_by STRING,
  last_updated_date DATE,
  limit_amnt_limit_1 FLOAT,
  limit_amnt_limit_10 FLOAT,
  limit_amnt_limit_11 FLOAT,
  limit_amnt_limit_12 FLOAT,
  limit_amnt_limit_13 FLOAT,
  limit_amnt_limit_2 FLOAT,
  limit_amnt_limit_3 FLOAT,
  limit_amnt_limit_4 FLOAT,
  limit_amnt_limit_5 FLOAT,
  limit_amnt_limit_6 FLOAT,
  limit_amnt_limit_7 FLOAT,
  limit_amnt_limit_8 FLOAT,
  limit_amnt_limit_9 FLOAT,
  limit_desc_limit_1 STRING,
  limit_desc_limit_10 STRING,
  limit_desc_limit_11 STRING,
  limit_desc_limit_12 STRING,
  limit_desc_limit_13 STRING,
  limit_desc_limit_2 STRING,
  limit_desc_limit_3 STRING,
  limit_desc_limit_4 STRING,
  limit_desc_limit_5 STRING,
  limit_desc_limit_6 STRING,
  limit_desc_limit_7 STRING,
  limit_desc_limit_8 STRING,
  limit_desc_limit_9 STRING,
  load_notes STRING,
  loss_cost_original STRING,
  mod_sate STRING,
  model_description STRING,
  model_make STRING,
  model_year_char STRING,
  nbfu_fire_protection_class STRING,
  occupancy_type STRING,
  organization STRING,
  other_mod FLOAT,
  package_mod FLOAT,
  percentage_broker_fee FLOAT,
  percentage_fees FLOAT,
  percentage_fronting_charge FLOAT,
  percentage_other FLOAT,
  percentage_tax FLOAT,
  policy_cancel_date DATE,
  policy_id_for_load STRING,
  policy_number STRING,
  pol_eff_dt DATE,
  premium_transaction_type STRING,
  premium_vehicle_type STRING,
  primary_coverage STRING,
  radius_class STRING,
  raiting_tier STRING,
  rate FLOAT,
  ssu STRING,
  schedule_mod FLOAT,
  source_trans_type STRING,
  special_waiver STRING,
  stated_amount FLOAT,
  stop_gap_EL_cov STRING,
  stop_gap_limits FLOAT,
  subline_code STRING,
  subline_description STRING,
  terminal_zone STRING,
  territory STRING,
  time_element_limit FLOAT,
  total_broker_fee FLOAT,
  total_fees FLOAT,
  total_fronting_charge FLOAT,
  total_net_premium FLOAT,
  total_other FLOAT,
  total_paid FLOAT,
  total_tax FLOAT,
  unit_business_use STRING,
  unit_garage_zip STRING,
  unit_number_char STRING,
  vehicle_class STRING,
  vin STRING,
  wind_hail_deductible FLOAT,
  year_built FLOAT,
  coverage_code STRING,
  coverage_effective_date DATE,
  coverage_expiration_date DATE,
  coverage_symbol STRING,
  coverage_type_code STRING,
  deductible_amount FLOAT,
  limit_amount_final FLOAT,
  limit_amount_initial FLOAT,
  original_coverage_code STRING,
  original_coverage_desc STRING,
  premium_manual_final FLOAT,
  premium_manual_initial FLOAT,
  premium_written_final FLOAT,
  premium_written_initial FLOAT,
  rating_company_factor FLOAT,
  rating_tier_factor FLOAT,
  schedule_mod_factor FLOAT,
  territory_factor FLOAT,
  transaction_type STRING,
  unit_type_code STRING,
  premium_created_date_char STRING,
  linked_policy_id STRING,
  total_gross_total_premium FLOAT,
  total_outstanding FLOAT,
  model_year FLOAT,
  unit_number FLOAT,
  premium_created_date DATE)
;
"""
spark_session.sql(sql_code)
